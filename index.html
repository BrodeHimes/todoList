<!DOCTYPE html>
<html>

<head>
  <title> Todo List</title>
  <style>
      body {
          display:flex ;
          flex-wrap: wrap;
          flex-direction: column;
          margin-left: 100px;
      }
      li {
          display:flex;
          justify-content: space-between;
          width: 500px;
      }
      .hidden {
          display:none;
      }

      #edit{

      }

      .inputBoxClass{
          width: 100%;
      }
  </style>
</head>

<body>
<header> 
    <h1> My Todo List</h1>
</header>

<main> 
    <form> 
        <label for="inputBox" ></label>
        <input type="text" id="inputBox" name="inputBox" autocomplete="off">
        <button type="button" id="create">Create</button>
        <button type="button" id="clear">Clear</button>
        <button type="button" id="deleteAll">Delete All</button>
    </form>
    <section id="todoListContainer">
        <p id="noItems">You don't have any todo items</p> 
        <ul id="todoList"></ul>
    </section>

</main>

<script>
    let inputBox = document.getElementById("inputBox");
    let create = document.getElementById("create");
    let todoList = document.getElementById("todoList");
    let noItemsMessage = document.getElementById("noItems");
    let clear = document.getElementById('clear');
    let deleteAll = document.getElementById('deleteAll');
    let todoListContainer= document.getElementById('todoListContainer');


//Create event handler
    let addTodoItem = ()=>{ 
        noItemsMessage.setAttribute('class', 'hidden');

        let itemToAdd = inputBox.value;
        let todoListItem = document.createElement("LI");
        todoListItem.setAttribute('class','todoListItemClass');
        todoListItem.innerHTML = itemToAdd+"<form><button type='button' id='edit' class='editClass'>Edit</button><button type='button'id='delete'>Delete</button></form> ";
       

        todoList.insertAdjacentElement('afterbegin',todoListItem);
        
        inputBox.value="";

        //calling edit button event handler
        let todoListItemClass=document.querySelectorAll("li.todoListItemClass");
        let editButtonClass=document.getElementsByClassName('editClass');
        editButtonClicked(editButtonClass);
        
    };


    let editButtonClicked=(classToLoop)=>{
        let populateInput = function(e){
            //makes it so that ONLY the edit button clicked will turn to input

            let listItemNowInput=e.target.parentNode.parentNode;
            let originalListElement=listItemNowInput.outerHTML;
            
            listItemNowInput.innerHTML="<label for='inputBox'></label><input type=text id='inputBox' class='inputBoxClass'>";
            console.log(originalListElement);

            //calling enter click event handler
            let inputBoxClass=document.getElementsByClassName('inputBoxClass');
            enterInputClicked(inputBoxClass,listItemNowInput,originalListElement);
         }

        for(let i=0; i<classToLoop.length;i++){
         classToLoop[i].addEventListener('click',populateInput);
        }
    }


    let enterInputClicked=(classToLoop,todoListItemToEdit,originalTodoItem)=>{
        for(let i=0; i<classToLoop.length;i++){
          classToLoop[i].addEventListener('keyup',function(e){
            let inputValue=e.target.value;
            if (e.keyCode === 13) {
              todoListItemToEdit.outerHTML='<li class="todoListItemClass">'+inputValue+"<form><button type='button' id='edit' class='editClass'>Edit</button><button type='button'id='delete'>Delete</button></form></li>";
              let editButtonClass=document.getElementsByClassName('editClass');
              editButtonClicked(editButtonClass,todoListItemToEdit);
            } else if (e.keyCode===27){
              todoListItemToEdit.innerHTML=originalTodoItem;
              let editButtonClass=document.getElementsByClassName('editClass');
              editButtonClicked(editButtonClass,todoListItemToEdit);
            }
          })
        }
    }
    
    

 

    create.addEventListener("click",addTodoItem);

//Clear event handler
    let clearInput = ()=>{
        inputBox.value="";
    }
    clear.addEventListener("click", clearInput);

//Delete All event handlder
    let deleteAllItems =()=>{
        todoList.innerHTML='';
        noItemsMessage.removeAttribute('class', 'hidden'); 
    }

    deleteAll.addEventListener('click',deleteAllItems);

</script>
  
</body>

</html>